<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EliteRentals - Property Listings</title>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
:root {
	--primary-color: #e4002b;
	--secondary-color: #1a1a1a;
	--bg-color: #f4f4f4;
	--text-color: #333;
	--light-gray: #e0e0e0;
}

* {
	box-sizing: border-box;
	margin: 0;
	padding: 0;
}

body {
	font-family: 'Arial', sans-serif;
	background-color: var(--bg-color);
	color: var(--text-color);
	line-height: 1.6;
}

.container {
	max-width: 1200px;
	margin: 0 auto;
	padding: 0 20px;
}

.navbar {
	background-color: #FF204E;
	color: white;
	padding: 10px 0;
}

.navbar .container {
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.navbar h1 {
	font-size: 24px;
}

.navbar a {
	color: white;
	text-decoration: none;
	margin-left: 20px;
}

.search-container {
	background-color: #FF204E;
	padding: 20px 0;
}

.search-form {
	display: flex;
	justify-content: center;
	align-items: center;
	gap: 10px;
}

.search-form select, .search-form button {
	padding: 10px 15px;
	border: none;
	border-radius: 4px;
	font-size: 16px;
}

.search-form button {
	background-color: var(--secondary-color);
	color: white;
	cursor: pointer;
	transition: background-color 0.3s;
}

.search-form button:hover {
	background-color: #333;
}

.properties-list {
	margin-top: 30px;
}

.property-card {
	background-color: white;
	border-radius: 8px;
	box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
	margin-bottom: 20px;
	overflow: hidden;
}

.property-card-header {
	position: relative;
}

.property-image {
	width: 100%;
	height: 200px;
	object-fit: cover;
}

.property-price {
	position: absolute;
	bottom: 10px;
	left: 10px;
	background-color: rgba(0, 0, 0, 0.7);
	color: white;
	padding: 5px 10px;
	border-radius: 4px;
}

.property-details {
	padding: 20px;
}

.property-title {
	font-size: 20px;
	margin-bottom: 10px;
}

.property-info {
	display: flex;
	justify-content: space-between;
	margin-bottom: 15px;
}

.property-info span {
	display: flex;
	align-items: center;
}

.property-info i {
	margin-right: 5px;
	color: var(--primary-color);
}

.property-description {
	margin-bottom: 15px;
	color: #666;
}

.property-actions {
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.book-now-btn {
	background-color: var(--primary-color);
	color: white;
	border: none;
	padding: 10px 20px;
	border-radius: 4px;
	cursor: pointer;
	transition: background-color 0.3s;
}

.book-now-btn:hover {
	background-color: #c5001f;
}

.comments-section {
	margin-top: 20px;
	background-color: #f9f9f9;
	border-radius: 8px;
	padding: 15px;
	max-height: 300px; /* Limiting the height of the comments section */
	overflow-y: auto; /* Adding vertical scroll for overflow */
}

.scrollable-comments {
	max-height: calc(100% - 60px); /* Adjust this value as necessary */
	overflow-y: auto;
}

.comment {
	background-color: white;
	border-radius: 4px;
	padding: 10px;
	margin-bottom: 10px;
}

.comment-form {
	margin-top: 10px;
	display: flex;
	gap: 10px;
}

.comment-form textarea {
	flex: 1;
	min-height: 50px; /* Adjust as needed */
	padding: 10px;
	border: 2px solid var(--light-gray);
	border-radius: 4px;
	resize: vertical;
}

.comment-form button {
	background-color: var(--primary-color);
	color: white;
	border: none;
	padding: 10px 5px;
	border-radius: 4px;
	cursor: pointer;
}

@media ( max-width : 768px) {
	.search-form {
		flex-direction: column;
	}
	.search-form select, .search-form button {
		width: 100%;
	}
}
</style>
</head>
<body>
	<nav class="navbar">
		<div class="container">
			<h1>EliteRentals</h1>
			<div>
				<a href="ContentPage.jsp">Home</a> <a href="#">My Account</a>
			</div>
		</div>
	</nav>

	<div class="search-container">
		<div class="container">
			<form action="/buyersearchview" method="post" class="search-form">
				<input type="hidden" name="action" value="search"> <input
					type="hidden" name="search" value="search"> <select
					name="location" id="location" required>
					<option value="">Select Location</option>
					<option value="Madurai">Madurai</option>
					<option value="Coimbatore">Coimbatore</option>
					<option value="Chennai">Chennai</option>
					<option value="Trichy">Trichy</option>
					<option value="Theni">Theni</option>
				</select> <select name="budget" id="budget" required>
					<option value="">Select Budget</option>
					<option value="1000">Up to 1,000</option>
					<option value="5000">Up to 5,000</option>
					<option value="10000">Up to 10,000</option>
					<option value="20000">Up to 20,000</option>
					<option value="50000">Up to 50,000</option>
				</select>
				<button type="submit">
					<i class="fas fa-search"></i> Search Properties
				</button>
			</form>
		</div>
	</div>

	<div class="container">
		<div class="properties-list">
			<div th:each="property : ${approvedProperties}" class="property-card">
				<div class="property-card-header">
					<div th:each="image : ${property.propertyImages}">
						<img th:src="@{'data:image/jpeg;base64,' + ${image}}" width="200"
							height="100" alt="Property Image" />
					</div>
					<div class="property-price"
						th:text="'â‚¹' + ${property.rent} + '/month'"></div>
				</div>
				<div class="property-details">
					<h2 class="property-title"
						th:text="${property.propertyType} + ' for Rent in ' + ${property.location}"></h2>
					<div class="property-info">
						<span><i class="fas fa-vector-square"></i> <span
							th:text="${property.sqft} + ' sq.ft'"></span></span> <span><i
							class="fas fa-couch"></i> <span th:text="${property.furnishing}"></span></span>
						<span><i class="fas fa-calendar-alt"></i> <span
							th:text="'Available from ' + ${property.availableFrom}"></span></span>
					</div>
					<p class="property-description" th:text="${property.address}"></p>
					<div class="property-actions">
						<form action="/Propertybuyer" method="post">
							<input type="hidden" th:value="${session.user.userid}" name="id">
							<input type="hidden" th:value="${property.propertyId}"
								name="propertyId"> <input type="hidden"
								th:value="${session.user.email}" name="buyerId"> <input
								type="hidden" th:value="${property.ownerId}" name="sellerId">
							<button type="submit" class="book-now-btn">Book Now</button>
						</form>
						<span><i class="fas fa-calendar-alt"></i> <span
							th:text="'Posted on: ' + ${property.postedOnDate}"></span></span>
					</div>
				</div>
				<div class="comments-section">
					<h3>Comments</h3>
					<div class="scrollable-comments">
						<div th:each="comment : ${comments}" class="comment"
							th:if="${comment.propertyid} == ${property.propertyId}">
							<strong th:text="${comment.commentsection}"></strong>
							<p th:text="${comment.usercomment}"></p>
						</div>
					</div>
				</div>
				<form action="/saveComment" method="post" class="comment-form">
					<input type="hidden" th:value="${session.user.userid}" name="id">
					<input type="hidden" th:value="${property.propertyId}"
						name="propertyId"> <input type="hidden"
						th:value="${session.user.username}" name="username">
					<textarea rows="3" name="comment"
						placeholder="Write your comment here..." required></textarea>
					<button type="submit">Post Comment</button>
				</form>
			</div>
		</div>
	</div>

	<p
		th:if="${approvedProperties == null or approvedProperties.isEmpty()}">No
		properties have been approved yet.</p>

	<script>
        // You can add JavaScript here for additional interactivity
    </script>
</body>
</html>
